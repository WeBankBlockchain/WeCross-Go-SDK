package cryptos

import (
	"fmt"
	"testing"
)

var (
	testPub = "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAxpO0sDr8aAqdWh/ExsEmwAgQRdglFV2Pz++2ve4n9q83IYTqI1heHI+++wIhclW2Z//tTGJyRiT0cZ2dyiG+KQyO+6h5v4/E7fTrsLKGszaOMvfjl06tDNOI4e52VQ1Gi9zXCePpPnpYLMZY36aeDQi6qGCE9HtFD/Rr2RtByr/SLjdbT1C5Br0HDEGXC8Lr3ht3xkb/xHVR0Egq3ywbxEUEChKM49qj8TA63gFHAmbDy7rDtjtXE8AmhPEgRQ7Ou6IgCSDWnC2AokI/RwCGM+Bz0l+JXjV1iK2kkOlThT36R8CAaAQhwjp2WESeFylx7p99x1fWQ4o7pwpXIQhwZxmMPosqtP9hknxdMDnwQ4LDNwlOkJuwE87dj8ZlArlYGl5lkZBgpAi/RRP4Kbm8hiKVvAPurLtLUfHmn95CS0ZVR69y74PRFQPsioSdc43dPuEBhVwl8TyLsKxJOuR4MEPa2low4IBordvtwbY3Nx5nsjUwUgmg6LVMfKQXasrdr08F8Ixnri2w4olqu55KgfY48Nc7zAZytReUqS/dPVgJwvNqFlFmS98/ihbaj5QqAafZfSYIpgx2wBEbEVyLaNbmVDpZmHbugyZeLPsffCWsQ+OnvWyfJDGLx3ISYuQ+00Ij5SWMC9OUX3aVckRqsr4CbRlp1SIO6GE2Jl9C7eMCAwEAAQ=="
	expect  = "&{810123381515457908563958855199846973573569877041788036857552779860818032944331218076986497741067466027178504345270969543314154708458075191119493718058842634180462055748222482653034738445037027619793926084539506772933626106054366992671652877868320181694442891482581913338513799455219957202546988384860266630089895992270345747962626572541421146769124498433193628835840041562341040124228272027483232129331840273299434031114996868195151111512963397467396403249278474522844031026362002783095721882728606253300029739916462221316751284588410386464702384049475901611485348082784444369035107424378650180480304701201568618929095766306147966383011290700070505343475572064114841528662139532097474174258660649365450000339292766023965501140213716013695179881092375571824147966886325415900801056428443412265698938518628047827500021928277611430201473424242740443269700367103080376306229053025384052343671506187605140608625640067022788025904340418138760781618204419223564721425301972542128353692975811439735480173905742811640469927175761885154075340052537864985845999695793647162378619883651739974009617163469895323763709314513148917435896889433948463400518809501770767609662171023064750147167860620752970689120161265973484911420031799476061777096163 65537}"
)

func TestCreatePublicKey(t *testing.T) {
	pubKey, err := CreatePublicKey(testPub)
	if err != nil {
		t.Fatalf("fail in create public key: %v", err)
	}
	res := fmt.Sprintf("%v", pubKey)
	if res != expect {
		t.Fatalf("Got unexpected public key\n want: %s\n,got: %s\n", expect, res)
	}
}

func TestEncryptBase64(t *testing.T) {
	pubKey, err := CreatePublicKey(testPub)
	if err != nil {
		t.Fatalf("fail in create public key: %v", err)
	}
	encrypted, err := EncryptBase64([]byte("this is a test"), pubKey)
	if err != nil {
		t.Fatalf("fail in encrypt: %v", err)
	}
	t.Logf("got encrypted bytes: %s", encrypted)
}
